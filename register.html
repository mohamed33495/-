<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">

    <title>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ | Ø´Ø­Ù†ØªÙŠ</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        ::-webkit-scrollbar {
            width: 0px;
            background: transparent;
        }

        input {
            -webkit-appearance: none;
            appearance: none;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="bg-gray-50 h-screen flex overflow-hidden">

    <!-- Form Container (Right side in RTL) -->
    <div class="w-full md:w-1/2 flex flex-col items-center bg-white p-6 md:p-12 overflow-y-auto">
        <div class="w-full max-w-sm my-auto">
            <a href="index.html" class="inline-flex items-center text-gray-400 hover:text-blue-600 mb-8 transition">
                <i class="fa-solid fa-arrow-right ml-2"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            </a>

            <div class="flex items-center gap-2 mb-6">
                <i class="fa-solid fa-paper-plane text-blue-600 text-3xl"></i>
                <span class="text-2xl font-bold text-gray-800">Ø´Ø­Ù†ØªÙŠ <span class="text-blue-600">App</span></span>
            </div>

            <h1 class="text-2xl md:text-3xl font-bold text-gray-900 mb-2">Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ ğŸš€</h1>
            <p class="text-gray-500 mb-8 text-sm md:text-base">Ø³Ø¬Ù„ Ù„Ø¯ÙŠÙ†Ø§ Ù„Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¥Ù„Ù‰ Ø´Ø¨ÙƒØ© Ø´Ø­Ù†ØªÙŠ.</p>

            <div class="flex bg-gray-100 p-1 rounded-xl mb-6">
                <button onclick="switchTab('client')" id="btn-client"
                    class="flex-1 py-2.5 rounded-lg text-sm font-bold shadow-sm bg-white text-blue-600 transition">
                    Ø£Ù†Ø§ Ø¹Ù…ÙŠÙ„
                </button>
                <button onclick="switchTab('driver')" id="btn-driver"
                    class="flex-1 py-2.5 rounded-lg text-sm font-bold text-gray-500 hover:text-gray-700 transition">
                    Ø£Ù†Ø§ ÙƒØ§Ø¨ØªÙ† (Ø³Ø§Ø¦Ù‚)
                </button>
            </div>

            <form id="form-client" action="#" onsubmit="registerClient(event)" class="tab-content active space-y-5">
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1.5">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ (English)</label>
                    <input type="text" placeholder="Mohamed Ali"
                        class="w-full pr-4 pl-4 py-3.5 border border-gray-200 rounded-xl focus:outline-none focus:border-blue-500 focus:ring-4 focus:ring-blue-50 transition dir-ltr text-left bg-gray-50 text-sm font-medium">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1.5">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="email" placeholder="name@example.com"
                        class="w-full pr-4 pl-4 py-3.5 border border-gray-200 rounded-xl focus:outline-none focus:border-blue-500 focus:ring-4 focus:ring-blue-50 transition bg-gray-50 text-sm font-medium">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1.5">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                    <input type="tel" placeholder="091 000 0000"
                        class="w-full pr-4 pl-4 py-3.5 border border-gray-200 rounded-xl focus:outline-none focus:border-blue-500 focus:ring-4 focus:ring-blue-50 transition dir-ltr text-left bg-gray-50 text-sm font-medium">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1.5">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                        class="w-full pr-4 pl-4 py-3.5 border border-gray-200 rounded-xl focus:outline-none focus:border-blue-500 focus:ring-4 focus:ring-blue-50 transition bg-gray-50 text-sm font-medium">
                </div>
                <div class="flex items-start gap-3 py-2">
                    <input type="checkbox"
                        class="mt-1 w-5 h-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500 bg-gray-100 border-2">
                    <label class="text-xs text-gray-500 leading-relaxed">Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù….</label>
                </div>
                <!-- Submit button was part of form-client, need to duplicate it or move it back? -->
                <!-- The original submit button at line 157 is for client? Or driver? -->
                <!-- Ah, the button at 157 says "Submit Request". -->
                <!-- Let's check where the button is. It's at 157, inside the merged form. -->

                <button type="submit"
                    class="w-full bg-slate-900 text-white font-bold py-3.5 rounded-xl hover:bg-slate-800 transition shadow-lg flex justify-center items-center gap-2 active:scale-95 transform mt-6">
                    ØªØ³Ø¬ÙŠÙ„ ÙƒØ¹Ù…ÙŠÙ„
                </button>
            </form>

            <form id="form-driver" action="#" onsubmit="submitDriverRequest(); return false;"
                class="tab-content space-y-5">

                <div class="grid grid-cols-2 gap-5">
                    <div>
                        <label class="block text-xs font-bold text-gray-700 mb-1">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„</label>
                        <input type="text"
                            class="w-full px-3 py-3 border border-gray-200 rounded-xl focus:border-blue-500 bg-gray-50 text-sm">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-700 mb-1">Ø§Ù„Ù„Ù‚Ø¨</label>
                        <input type="text"
                            class="w-full px-3 py-3 border border-gray-200 rounded-xl focus:border-blue-500 bg-gray-50 text-sm">
                    </div>
                </div>

                <div>
                    <label class="block text-xs font-bold text-gray-700 mb-1">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="email" placeholder="name@example.com"
                        class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:border-blue-500 bg-gray-50 text-sm text-right">
                </div>

                <div>
                    <label class="block text-xs font-bold text-gray-700 mb-1">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                    <input type="tel" placeholder="091..."
                        class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:border-blue-500 bg-gray-50 text-sm text-left"
                        dir="ltr">
                </div>

                <div>
                    <label class="block text-xs font-bold text-gray-700 mb-1">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                        class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:border-blue-500 bg-gray-50 text-sm text-right">
                </div>

                <div>
                    <label class="block text-xs font-bold text-gray-700 mb-1">Ù†ÙˆØ¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙˆØ§Ù„Ù…ÙˆØ¯ÙŠÙ„</label>
                    <input type="text" placeholder="Ù…Ø«Ù„Ø§Ù‹: Toyota Camry 2015"
                        class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:border-blue-500 bg-gray-50 text-sm text-right">
                </div>

                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2">ØµÙˆØ±Ø© Ø±Ø®ØµØ© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©</label>
                    <label
                        class="flex flex-col items-center justify-center w-full h-28 border-2 border-dashed border-gray-300 rounded-xl cursor-pointer bg-gray-50 hover:bg-gray-100 transition group">
                        <div class="flex flex-col items-center justify-center pt-5 pb-6">
                            <i
                                class="fa-solid fa-id-card text-gray-400 text-2xl mb-2 group-hover:text-blue-500 transition"></i>
                            <p class="text-xs text-gray-500 font-bold">Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©</p>
                        </div>
                        <input type="file" class="hidden" onchange="handleFileSelect(this)">
                    </label>
                </div>

                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2">ØµÙˆØ±Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø©</label>
                    <label
                        class="flex flex-col items-center justify-center w-full h-28 border-2 border-dashed border-gray-300 rounded-xl cursor-pointer bg-gray-50 hover:bg-gray-100 transition group">
                        <div class="flex flex-col items-center justify-center pt-5 pb-6">
                            <i
                                class="fa-solid fa-car text-gray-400 text-2xl mb-2 group-hover:text-blue-500 transition"></i>
                            <p class="text-xs text-gray-500 font-bold">Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©</p>
                        </div>
                        <input type="file" class="hidden" onchange="handleFileSelect(this)">
                    </label>
                </div>

                <button type="submit"
                    class="w-full bg-slate-900 text-white font-bold py-3.5 rounded-xl hover:bg-slate-800 transition shadow-lg flex justify-center items-center gap-2 active:scale-95 transform mt-6">
                    Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù†Ø¶Ù…Ø§Ù…
                </button>
            </form>

            <p class="mt-8 text-center text-sm text-gray-600">
                Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ <a href="login.html" class="text-blue-600 font-bold hover:underline">Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ</a>
            </p>
        </div>
    </div>

    <!-- Image Container (Left side in RTL) -->
    <div class="hidden md:block w-1/2 bg-blue-900 relative overflow-hidden">
        <img src="https://images.unsplash.com/photo-1494412574643-35d32468817e?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80"
            class="absolute inset-0 w-full h-full object-cover opacity-30 mix-blend-overlay hover:scale-105 transition duration-1000">
        <div class="absolute bottom-0 right-0 p-16 text-white z-10">
            <h2 class="text-5xl font-black mb-6 leading-tight">Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„Ø©<br>Ø§Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©.</h2>
            <p class="text-blue-200 text-xl max-w-md">Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø´Ø¨ÙƒØ© Ø´Ø­Ù†ØªÙŠ Ø§Ù„Ù…ØªØ·ÙˆØ±Ø©.</p>
        </div>
    </div>

    <script>
        async function registerClient(e) {
            e.preventDefault();
            const form = document.getElementById('form-client');
            const inputs = form.querySelectorAll('input');

            const name = inputs[0].value;
            const email = inputs[1].value;
            const phone = inputs[2].value;
            const password = inputs[3].value;

            try {
                const response = await fetch('http://localhost:3000/api/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, phone, password, role: 'client' })
                });

                const data = await response.json();
                if (data.success) {
                    alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†.');
                    window.location.href = 'login.html';
                } else {
                    alert('Ø®Ø·Ø£: ' + data.message);
                }
            } catch (error) {
                console.error('Register Error:', error);
                alert('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ server.js');
            }
        }

        function switchTab(type) {
            const btnClient = document.getElementById('btn-client');
            const btnDriver = document.getElementById('btn-driver');
            const formClient = document.getElementById('form-client');
            const formDriver = document.getElementById('form-driver');

            if (type === 'client') {
                btnClient.className = "flex-1 py-2.5 rounded-lg text-sm font-bold shadow-sm bg-white text-blue-600 transition";
                btnDriver.className = "flex-1 py-2.5 rounded-lg text-sm font-bold text-gray-500 hover:text-gray-700 transition";
                formClient.classList.add('active');
                formDriver.classList.remove('active');
            } else {
                btnDriver.className = "flex-1 py-2.5 rounded-lg text-sm font-bold shadow-sm bg-white text-blue-600 transition";
                btnClient.className = "flex-1 py-2.5 rounded-lg text-sm font-bold text-gray-500 hover:text-gray-700 transition";
                formDriver.classList.add('active');
                formClient.classList.remove('active');
            }
        }

        async function submitDriverRequest() {
            const form = document.getElementById('form-driver');
            const inputs = form.querySelectorAll('input');

            // 0: FirstName, 1: LastName, 2: Email, 3: Phone, 4: Password, 5: CarType, 6: LicFile, 7: CarFile
            const firstName = inputs[0].value.trim();
            const lastName = inputs[1].value.trim();
            const email = inputs[2].value.trim();
            const phone = inputs[3].value.trim();
            const password = inputs[4].value.trim();
            const carType = inputs[5].value.trim();

            const licenseFile = inputs[6].files.length;
            const carFile = inputs[7].files.length;

            // 1. Check Empty Fields
            if (!firstName || !lastName || !email || !phone || !password || !carType) {
                alert('Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù…Ø·Ù„ÙˆØ¨Ø©. ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ ÙƒØ§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.');
                return;
            }

            // 2. Name Validation
            const nameRegex = /^[a-zA-Z\u0600-\u06FF\s]+$/;
            if (!nameRegex.test(firstName) || !nameRegex.test(lastName)) {
                alert('Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù„Ù‚Ø¨ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø­Ø±ÙˆÙ ÙÙ‚Ø·.');
                return;
            }

            // 3. Email Validation
            if (!email.includes('@') || !email.includes('.com')) {
                alert('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­.');
                return;
            }

            // 4. Phone Validation
            const phoneRegex = /^(091|092|093|094)\d{7}$/;
            if (!phoneRegex.test(phone) || phone.length !== 10) {
                alert('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ØºÙŠØ± ØµØ§Ù„Ø­.');
                return;
            }

            // 5. Password Validation
            if (password.length <= 8) {
                alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø£ÙƒØ«Ø± Ù…Ù† 8 Ø®Ø§Ù†Ø§Øª.');
                return;
            }

            // 6. File Validation
            if (licenseFile === 0 || carFile === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.');
                return;
            }

            // Show Loading
            const btn = form.querySelector('button[type="submit"]');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';
            btn.disabled = true;

            const fullName = firstName + ' ' + lastName;

            try {
                const response = await fetch('http://localhost:3000/api/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: fullName,
                        email,
                        phone,
                        password,
                        role: 'driver',
                        carType
                    })
                });

                const data = await response.json();

                if (data.success) {
                    alert('âœ… ' + data.message);
                    window.location.href = 'login.html';
                } else {
                    alert('âŒ ' + data.message);
                }
            } catch (error) {
                console.error(error);
                alert('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù….');
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }
        function handleFileSelect(input) {
            if (input.files && input.files[0]) {
                const label = input.closest('label');
                const text = label.querySelector('p');
                const icon = label.querySelector('i');

                text.textContent = input.files[0].name;
                text.classList.add('text-blue-600');

                icon.className = 'fa-solid fa-circle-check text-blue-500 text-3xl mb-2 transition';
            }
        }
    </script>

</body>

</html>